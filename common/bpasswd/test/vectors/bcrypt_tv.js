var tv = [
{ 'cost': '10', 'password': 'password.', 'ct': 'dc61c18a78e870d4c99510a786893cabf4c62ea4ba782d34', 'salt': '8702402409ff8cca151b1e0d63b27194' },
{ 'cost': '10', 'password': 'password.', 'ct': '930186c31ec76ca42b28284e38ce76422a00edd0f12b9ec1', 'salt': '3268636ded20bdbd6f6899cf9123cf19' },
{ 'cost': '10', 'password': 'password.', 'ct': '9b0416eac5e0e986acb9e0c8ffaa8dc0afa27fc3ed944df7', 'salt': '250f3d2e0ecaf823e5163048c9a2dcfb' },
{ 'cost': '10', 'password': 'password.', 'ct': '7d087d4229d7b8d3c8694448d25893d5f679fe5ac204d5e2', 'salt': '0a3f69f76026b4cf8e4d9e20706d3995' },
{ 'cost': '10', 'password': 'password.', 'ct': '8be6b2f1e79ffce27558cb8d0ef8f2b714bf155d4e621c23', 'salt': '7c76c38a40bbad25d2dd6d9b7f4a968a' },
{ 'cost': '10', 'password': 'password.', 'ct': '0332e7a36592eb3a251318e62d2d09f1dcee9bd30f20f337', 'salt': '89ff81e92536b8b48356d4f4c30d893f' },
{ 'cost': '10', 'password': 'password.', 'ct': '6b2909a9979f787ba8284a3297c9a0a63fa5da3a535f9131', 'salt': '834dc9c40876e9da545775d3a10c5d2a' },
{ 'cost': '10', 'password': 'password.', 'ct': '9109a960da5289c1754785d7b1bf2ced330530d1d7d2f789', 'salt': '0bdf143115cce59823b98ce6c6162649' },
{ 'cost': '10', 'password': 'password.', 'ct': '9f3990a779dc34973a464ee2c903a837906882e54dc3f805', 'salt': '63ef0d6b66f746ba4ebb8defc7eb19d3' },
{ 'cost': '10', 'password': 'password.', 'ct': '931c6e5b68c129e9be7e9272a63e57b7fc7c2a1b89ebabe6', 'salt': 'ca2d04dffae9771da20403681a29b17d' },
{ 'cost': '10', 'password': 'password.', 'ct': 'c2297ec5618e968d469f9d4d04c10f8e6e22bfc0c6c6d939', 'salt': '19bfe87fb62e3904eac6f3b1b10c847b' },
{ 'cost': '10', 'password': 'password.', 'ct': '85bde5bdc72a058abac7cad5b323cdd73efe5a3bf6c18f25', 'salt': '3a885a3471d25113d6547bf07e2d6d97' },
{ 'cost': '10', 'password': 'password.', 'ct': '8ffbb4f82a318ba51fd6267e0497a801acdad6a4bf282d78', 'salt': 'ec5516a2844fa66e15991fc7a5a442df' },
{ 'cost': '10', 'password': 'password.', 'ct': 'bf2b0cdaf0b4421a90d919dc794097fd5770312df941c498', 'salt': '2c9d139e6f64b145b92d35375aa2ce46' },
{ 'cost': '10', 'password': 'password.', 'ct': 'baa66721958f5783e839d6d6c4caf1c3902b5a84e94b5894', 'salt': 'f7e4e87b338ee94827090fccad52acd9' },
{ 'cost': '10', 'password': 'password.', 'ct': '9f8167f22f462433e65c40cd39db5ec0df788b37efe29846', 'salt': 'efbf775e2429a3dd56d814b07ae2f671' },
{ 'cost': '10', 'password': 'password.', 'ct': '2d9dfbb71371d7b51661fccd2452c6dbddea3922506451cb', 'salt': 'c6deedf96cd64193df515f8ca30b6692' },
{ 'cost': '10', 'password': 'password.', 'ct': '41ef3631ccf10996b7285258fa385779d7d5905791300887', 'salt': 'cbddf0ef0693cc5c6be00ce5c2025688' },
{ 'cost': '10', 'password': 'password.', 'ct': '8d7cf83c9050148195b1b8c0b25bb0d435c2b0460f4db5bc', 'salt': 'e043814c1ac2dff9133f86b64aec4815' },
{ 'cost': '10', 'password': 'password.', 'ct': 'e4510a4a6cafb8dfcaa9d8af0bac3e1ccf97d5ea437d5fb9', 'salt': 'c93804d0cbd02c36b0391b723b72fa1c' },
{ 'cost': '10', 'password': 'password.', 'ct': '75103eb0b50651ef5b4b6451cb5fe528a07dd0555ac66c76', 'salt': 'b57b68cf3e48c951874f08d13b50e704' },
{ 'cost': '10', 'password': 'password.', 'ct': 'cf9630efc24463cb4590f622cc9fec1464624121d5c4f0ab', 'salt': '89ebd454bc018b6c3aa6df7518d991ce' },
{ 'cost': '10', 'password': 'password.', 'ct': '6b8fccf654ace03e22e98120da2b8bf0ecaf12c78fe57386', 'salt': '55fa9d934266e4c9b5ec9af03d81f5c6' },
{ 'cost': '10', 'password': 'password.', 'ct': 'df866b91133ca3aeb8a671d7d200aacca09ad2550d1b3e81', 'salt': '6dc91a29caa595044c747a644e0b32a3' },
{ 'cost': '10', 'password': 'password.', 'ct': '3ed882f5bc6fb35998662a2b1e9bc09840d13f7d3279a05f', 'salt': '05d03647361a10ec07abdc442cd10a99' },
{ 'cost': '10', 'password': 'password.', 'ct': 'da79c323c953a45d298f7294a633995d6515ebdea457eb70', 'salt': '9b24c265ca586a16cce47a1aefadbdf5' },
{ 'cost': '10', 'password': 'password.', 'ct': 'bca64b56b3f11433573ed83201c811516e38970ef0093630', 'salt': '7df33cb30e4d9f15f87c59244d63bee8' },
{ 'cost': '10', 'password': 'password.', 'ct': 'e69ed46eb58ddeae29c2fa53bb67b1defe77dc91e098a299', 'salt': '87804e51d8b867a59ce2bf8b8f7d800c' },
{ 'cost': '10', 'password': 'password.', 'ct': 'a0b9cf4c5b1d01efd8ad193be53b45cc2a74581f4cd81222', 'salt': '70bdbf7e0a5f9302dbec26284fe411d7' },
{ 'cost': '10', 'password': 'password.', 'ct': '012826fdaa1474ca16264c16ad48fd762de37048a8c82667', 'salt': '655f283d1790e2b372a23e011fbf0d8f' },
{ 'cost': '10', 'password': 'password.', 'ct': '404941aee2e790be81a0fd82771c7f32ffaff592eb8d924a', 'salt': '7ccc0e862ba188068eae2fdd9340b4f8' },
{ 'cost': '10', 'password': 'password.', 'ct': '5cf0220602b74a23629d21b2f13f04bc2bb106ab2b9ce268', 'salt': '9fdd35b66d1869dfbaa7e0d966ed68e2' }
];


function factoryTestBCrypt(test_vector) {
  return function() {
    var bc = new BCrypt();

    var salt = EncDec.hex.decode(test_vector.salt);
    var pwd = EncDec.ascii.decode(test_vector.password);
    var ct = bc.bcrypt(test_vector.cost, salt, pwd);
    ct = EncDec.hex.encode(ct);

    equal(ct.toLowerCase(), test_vector.ct, "Correct ciphertext: "+test_vector.ct);
  };
}


for (var idx in tv) {
  test("BCrypt vector "+idx, factoryTestBCrypt(tv[idx]));
}
